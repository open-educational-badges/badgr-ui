<main class="page-padding">
	<nav class="oeb-breadcrumbs">
		<bg-breadcrumbs [linkentries]="linkentries"></bg-breadcrumbs>
	</nav>

	<header class="tw-relative tw-mt-20">
		<h2 class="tw-text-purple tw-mb-8 tw-uppercase tw-text-[22px] tw-font-bold tw-leading-[120%]">
			{{ 'General.network' | translate }}
		</h2>

		<div class="tw-grid tw-grid-cols-1 lg:tw-grid-cols-[1fr_340px] tw-gap-x-6">
			<!-- Left column: Main content -->
			<div class="tw-col-start-1">
				<section class="tw-flex tw-gap-6 oeb" aria-labelledby="network-info">
					<figure class="tw-relative">
						<img
							[loaded-src]="network?.image"
							[loading-src]="networkPlaceholderSrc"
							[error-src]="networkPlaceholderSrc"
							alt="{{ network.name }} logo"
							class="tw-h-[70px] md:tw-h-[100px] tw-w-auto tw-min-w-[70px] md:tw-min-w-[100px] tw-aspect-square"
						/>
					</figure>

					<hgroup class="tw-flex tw-flex-col tw-justify-center tw-pl-8 tw-max-w-[80%] oeb-break-words">
						<h1
							id="network-info"
							hlmH1
							class="tw-text-purple tw-font-semibold md:tw-text-[35px] xl:tw-text-[46px]"
						>
							{{ network.name }}
						</h1>
						@if (public && network.url) {
							<p hlmP size="sm">
								<a hlmA target="_blank" [href]="network.url" rel="noopener noreferrer">
									{{ network.url }}
								</a>
							</p>
						}
					</hgroup>
				</section>

				<section aria-labelledby="description-heading" class="tw-mt-4">
					<h2 id="description-heading" class="tw-sr-only">Network Description</h2>
					<p class="tw-text-oebblack tw-text-lg oeb-break-words">
						{{ network.description }}
					</p>
				</section>

				<ng-container>
					<div class="tw-my-12">
						<oeb-tabs
							[variant]="'bluebackground'"
							(onTabChanged)="onTabChange($event)"
							[activeTab]="activeTab"
							[tabs]="tabs"
							countStyle="parentheses"
						></oeb-tabs>
					</div>
				</ng-container>

				<ng-container
					[ngTemplateOutlet]="activeTab === 'network' ? networkTemplate : partnerTemplate"
				></ng-container>
			</div>

			<!-- Right column: Sidebar -->
			<aside
				class="tw-hidden lg:tw-block tw-row-start-1 tw-col-start-2 tw-sticky tw-top-8 tw-self-start"
				aria-label="Network actions and partners"
			>
				@if (public) {
					<nav aria-label="Network actions" class="tw-flex tw-flex-col tw-gap-2">
						<oeb-button
							width="min_320"
							class="tw-whitespace-nowrap"
							(click)="routeToUrl(network.url)"
							[text]="'Network.website' | translate"
						>
						</oeb-button>
						@if (userIsMember) {
							<oeb-button
								(click)="routeToMemberView()"
								class="tw-whitespace-nowrap"
								[text]="'Issuer.memberView' | translate"
								variant="secondary"
								width="min_320"
							>
							</oeb-button>
						}
					</nav>
				}

				<section
					class="tw-bg-oebgrey tw-mt-4 tw-rounded-[10px] tw-p-4 tw-flex tw-flex-col tw-justify-center tw-items-center"
					aria-labelledby="partners-heading"
				>
					<h2
						id="partners-heading"
						class="tw-w-full tw-text-oebblack tw-text-lg tw-font-semibold tw-uppercase"
					>
						{{ 'Network.partner' | translate }}
					</h2>
					<ul class="tw-w-full tw-list-none tw-mt-2" role="list">
						@for (issuer of issuers; track issuer) {
							<li class="tw-flex tw-gap-2 tw-items-center tw-mt-2">
								<a
									[routerLink]="['/public/issuers', issuer.slug]"
									class="tw-flex tw-gap-2 tw-items-center tw-no-underline hover:tw-underline"
									[attr.aria-label]="'Visit ' + issuer.name + ' profile'"
								>
									<img class="tw-w-[33px]" [src]="issuer.image" [alt]="issuer.name + ' logo'" />
									<span class="tw-text-oebblack">
										{{ issuer.name }}
									</span>
								</a>
							</li>
						}
					</ul>
				</section>
			</aside>
		</div>
	</header>
</main>

<ng-template #networkTemplate>
	<div class="tw-gap-6 tw-grid tw-grid-cols-badges tw-mt-6">
		@for (badge of networkBadges; track badge.slug) {
			<bg-badgecard
				[badgeTitle]="badge.name"
				[badgeImage]="badge.image"
				[badgeDescription]="badge.description"
				[badgeSlug]="badge.slug"
				[issuerTitle]="badge.issuerName"
				[badgeIssueDate]="badge.createdAt"
				[public]="true"
				[network]="true"
				[publicUrl]="badge.url"
				[issuerSlug]="badge.issuerSlug"
				[competencies]="badge.extension['extensions:CompetencyExtension']"
				[category]="badge.extension['extensions:CategoryExtension'].Category"
				[tags]="badge.tags"
			></bg-badgecard>
		}
	</div>
</ng-template>

<ng-template #partnerTemplate>
	<div class="tw-gap-6 tw-grid tw-grid-cols-badges tw-mt-6">
		@for (badge of partnerBadges; track badge.id) {
			<bg-badgecard
				[badgeTitle]="badge.badgeclass.name"
				[badgeImage]="badge.badgeclass.image"
				[badgeDescription]="badge.badgeclass.description"
				[badgeSlug]="badge.badgeclass.slug"
				[issuerTitle]="badge.shared_by_issuer.name"
				[badgeIssueDate]="transformDate(badge.shared_at)"
				[public]="true"
				[publicUrl]="badge.badgeclass.json.id"
				[issuerSlug]="badge.shared_by_issuer.slug"
				[competencies]="badge.badgeclass.extensions['extensions:CompetencyExtension']"
				[category]="badge.badgeclass.extensions['extensions:CategoryExtension'].Category"
				[tags]="badge.badgeclass.tags"
			></bg-badgecard>
		}
	</div>
</ng-template>
